{% extends "base.html" %} {% block title %} Trade {% endblock %} 
{% block content%} 
{% for mainkey in response %} 
{% if mainkey == request.args.get('token') %} 
{% set cenaKripta = response[mainkey]['quote']['USD']['price'] %} 
{% set nazivKripta = response[mainkey]['name'] %}

<br><br>
<div style="text-align: center;">
  <br>
  <h3>Kriptovaluta: {{response[mainkey]['name']}}</h3><br>
  <h4>Cena kripto valute: {{cenaKripta}}</h4><br>

  <h5>ULOZENO NOVCA: 
    <input type="number" id="kolikoNovca" name="kolikoNovca" /><br><br>
    <button onclick="myFun(kolikoNovca.value, `{{cenaKripta}}`, `{{nazivKripta}}`)">DALJE</button>
  </h5>
</div>
{% endif %} 
{% endfor %}

{% if request.args.get('kolicinaNovca') %} 
{% set kolicinaNovca = request.args.get('kolicinaNovca') | float %}
{% set cenaKripta = request.args.get('cenaKripta') | float %}
{% set nazivKripta = request.args.get('nazivKripta') %}

<br><br>
<div style="text-align: center;">
  <br><br><br>
  <h2>{{ kolicinaNovca }} $ = {{ kolicinaNovca / cenaKripta }} {{nazivKripta}}</h2><br><br>
  <button style="width: 200px; height: 50px;" onclick="myFun2(`{{kolicinaNovca}}`, `{{cenaKripta}}`, `{{nazivKripta}}`)" >KUPI</button>
</div>

{% endif %}

<script>
  function myFun(kolikoNovca, cenaKripta, nazivKripta) {
    console.log(kolikoNovca);
    console.log(cenaKripta);
    console.log(nazivKripta);

    window.location.href = `http://127.0.0.1:5000/trade?kolicinaNovca=${kolikoNovca}&cenaKripta=${cenaKripta}&nazivKripta=${nazivKripta}`;
  }
</script>

<script>
  function myFun2(kolikoNovca, cenaKripta, nazivKripta) {
    window.location.href = `http://127.0.0.1:5000/buyKripto?nazivKripta=${nazivKripta}&kolikoKripta=${kolikoNovca / cenaKripta}&kolicinaNovca=${kolikoNovca}`;
  }
</script>

{% endblock %}
